<!DOCTYPE HTML>
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
		<meta name="format-detection" content="telephone=no">
		<meta name="viewport" content="user-scalable=no,initial-scale=1,maximum-scale=1,minimum-scale=1,width=device-width/2,height=device-height/2,target-densitydpi=device-dpi/2">
		<link rel="stylesheet" type="text/css" href="../../css/index.css">
		<title>About Me</title>
	</head>
	<body>
		<div id="header">
			<div id="stream"><a href="../../">主页</a> &gt; <a href="../">日志列表</a> &gt; 2015.12.19 </div>
		</div>
		<div id="container">
			早上九点多被同学紧急召唤去图书馆，说是在图书馆的电脑上中了病毒，U 盘中全部文件都变成了快捷方式，无法打开。<br />
			那个同学说发现了这个情况后完全不敢做什么，立刻就来联系我了。<br />
			在这个 Windows 的世界，任何企图将 Windows 从你脑中清空的努力都会是徒劳。<br />
			毕竟这是个 Windows 的天下，在你快忘记的时候总会有人提醒你去回忆的。<br />
			之前另外有一个同学也是遇到这个病毒（virus.lnk.vbsworm.b）,然后 360 不断报毒，并且将这些快捷方式全部移除。当看到 U 盘没有文件而 360 显示有几个 G 的占用的时候这个同学选择了格式化 U 盘。
			数据恢复。<br />
			客户只要求恢复两个文件夹的内容，最后结果一个成功一个失败。<br />
			回到正文。<br />
			带上电脑赶去图书馆，一路上 Linuxer 的优越感油然而生 2333<br />
			只看到金山毒霸提示一个名字为 flgjahzqvm.vbs 的文件有危险询问是否删除。<br />
			.vbs，第一反应去任务管理器结束掉 wscript.exe。<br />
			但是上次同样结束后发现那个文件也顺便消失了，这次准备活捉它。<br />
			按照 wscript.exe 中执行的命令行一路追下去，发现追到一半没法进去了，因为这个账户不是管理员账户，另寻他径吧。<br />
			在上一步的时候已经设置显示隐藏文件为开，回到 U 盘看的时候发现 U 盘中有同名隐藏文件，1M。大喜。复制出来。<br />
			此时金山毒霸再次报警告（但是没有移除文件），我便准备把病毒样本带走，但是我的电脑当时并没有运行 FTP 服务器，也没有带 U 盘（有也不能用），突然想到了云盘，于是把它上传到 360 云盘。<br />
			顺便用记事本打开一看，卧槽这可以算是加壳过的，但是每个“数字”都不超过 128，推测使用 ASCII 加壳。<br />
			但是现在要做的是（可能是暂时地）手解病毒。<br />
			先把 wscript.exe 结束了。<br />
			顺带一吐槽 wscript.exe 功能太强大导致病毒都可以利用。嗯。<br />
			然后把被隐藏的文件解除隐藏。<br />
			先是随便一个文件右键属性，发现隐藏的属性没法去掉。<br />
			因此必定文件被加上了系统属性，只能走命令行了。<br />
			WinKey + R, cmd, Enter.<br />
			G:<br />
			attrib -s -h G:\*.* /s /d<br />
			其中 -s 去系统属性，-h 去隐藏属性，/s /d 合并起来为递归处理文件夹内全部文件。<br />
			等了好久，以为这个 attrib 还被劫持了，于是 Ctrl + Z 掉，试一下：<br />
			attrib -s -h G:\*.*<br />
			这个 U 盘的根目录只有五个文件，然后发现一眨眼就好了，于是再次 /s /d，等久一会吧。<br />
			等了大约两分多钟，attrib 顺利退出。全部文件（包括 System Volume Information）都被解除了系统隐藏属性。<br />
			把 flgjahzqvm.vbs 从容删除。<br />
			现在有 31 个文件/文件夹，除了 System Volume Information 之外就剩下 30 个，快捷方式有 15 个，正确。<br />
			把快捷方式删掉，此时全部影响应该就解除了。<br />
			然后随便打开几个文件，发现数据都没事。安好。<br />
			那个同学拔出了 U 盘，然后只敢看书了，然后以后来图书馆都要带电脑了。<br />
			“看个课件都那么多事。”<br />
			回到宿舍，把文件下载下来，准备解码并分析。<br />
			文件被加密过。<br />
			未完待续。<br />
		</div>
		<iframe id="footer" src="../../footer.html" scrolling="no">
		</iframe>
	</body>
</html>
